# 母婴商城系统架构设计

本文档详细介绍母婴商城系统的整体架构设计，包括前后端分离架构、微服务拆分、数据流向以及技术选型理由。

## 系统架构图

```
┌─────────────┐      ┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│   用户浏览器  │ <──> │  前台商城系统 │      │  后台管理系统 │ <──> │ 管理员浏览器 │
└─────────────┘      └──────┬──────┘      └──────┬──────┘      └─────────────┘
                           │                     │
                           ▼                     ▼
                     ┌─────────────────────────────────┐
                     │        API 网关 / 后端服务        │
                     └─────────────┬─────────────────┬─┘
                                   │                 │
                    ┌──────────────▼──┐    ┌─────────▼────────┐
                    │    MySQL 数据库  │    │ Redis/ElasticSearch│
                    └─────────────────┘    └──────────────────┘
```

## 前后端分离架构

母婴商城采用了完全的前后端分离架构，前端和后端作为独立的应用程序开发和部署，通过API接口进行通信。

### 前端架构

前端分为两个独立的应用：

1. **前台商城系统 (muying-web)** 
   - 基于Vue 3 + Vite构建
   - 采用组合式API和Pinia状态管理
   - 使用Element Plus和TailwindCSS构建UI
   - 实现响应式设计，适配多种设备尺寸

2. **后台管理系统 (muying-admin-react)**
   - 基于React + TypeScript构建
   - 使用Redux Toolkit进行状态管理
   - 采用Ant Design组件库
   - 集成数据可视化和权限管理功能

### 后端架构

后端API服务(muying-mall)基于Spring Boot构建，主要组件包括：

- **Controller层**：处理HTTP请求，进行参数验证和错误处理
- **Service层**：实现业务逻辑，事务管理
- **DAO/Repository层**：数据访问层，与数据库交互
- **Model层**：业务实体和数据传输对象(DTO)

## 数据存储架构

母婴商城使用多种数据存储技术，满足不同场景的需求：

1. **MySQL**：关系型数据库，存储核心业务数据
   - 用户信息、商品信息、订单数据等

2. **Redis**：内存数据库，用于缓存和分布式功能
   - 会话管理
   - 热点数据缓存
   - 分布式锁
   - 计数器和限流

3. **Elasticsearch**：搜索引擎
   - 商品全文检索
   - 日志聚合分析
   - 相关商品推荐

## 认证与安全架构

系统安全架构基于以下组件：

1. **JWT认证**：无状态的用户认证机制
   - 访问令牌(Access Token)和刷新令牌(Refresh Token)机制
   - 令牌过期策略
   - 黑名单机制

2. **Spring Security**：安全框架
   - 基于角色的访问控制(RBAC)
   - 请求过滤和安全检查
   - 防CSRF攻击

3. **接口加密**：敏感API的通信安全
   - HTTPS传输加密
   - 请求签名验证
   - 敏感数据加密

## 性能与扩展性设计

为了确保系统的高性能和可扩展性，采用了以下策略：

1. **缓存策略**
   - 多级缓存设计：本地缓存 + 分布式缓存
   - 热点数据缓存
   - 缓存预热和更新策略

2. **数据库优化**
   - 数据库分表分库策略
   - 读写分离
   - 索引优化

3. **水平扩展**
   - 无状态设计，支持多实例部署
   - 负载均衡
   - 服务发现和服务注册

## 部署架构

母婴商城系统采用容器化部署策略：

1. **Docker容器**
   - 前端应用容器化
   - 后端服务容器化
   - 依赖服务容器化(Redis, MySQL, Elasticsearch)

2. **CI/CD流程**
   - 自动化构建和测试
   - 蓝绿部署或金丝雀部署
   - 自动化回滚机制

## 技术栈选型理由

### 前端技术选型

1. **Vue 3 / React**：
   - Vue 3提供更好的性能和组合式API，简化状态管理
   - React提供强大的组件模型和丰富的生态系统
   - 两种框架都有良好的TypeScript支持

2. **Vite / Redux Toolkit**：
   - Vite提供极速的开发体验和构建性能
   - Redux Toolkit简化Redux使用，减少样板代码

3. **Element Plus / Ant Design**：
   - 成熟的组件库，提供丰富的UI组件
   - 良好的主题定制能力
   - 完善的文档和社区支持

### 后端技术选型

1. **Spring Boot**：
   - 简化Java开发，提供自动配置
   - 丰富的生态系统和社区支持
   - 易于集成各种中间件和服务

2. **MyBatis-Plus**：
   - 增强的MyBatis功能，简化CRUD操作
   - 代码生成和分页等功能
   - 性能优于JPA/Hibernate

3. **Redis**：
   - 高性能的内存数据库
   - 丰富的数据结构
   - 支持分布式锁、缓存等功能

4. **Elasticsearch**：
   - 高性能的全文搜索引擎
   - 分布式架构，支持水平扩展
   - 丰富的查询和分析功能

## 子系统架构

可以查看各子系统的详细架构文档：

- [前台商城系统架构](./frontend-web.md)
- [后台管理系统架构](./frontend-admin.md)
- [后端API服务架构](./backend.md) 